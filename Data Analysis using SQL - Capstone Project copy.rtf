{\rtf1\ansi\ansicpg1252\cocoartf2638
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;\red10\green19\blue32;\red255\green255\blue255;}
{\*\expandedcolortbl;;\cssrgb\c3922\c9804\c16863;\cssrgb\c100000\c100000\c100000;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid1\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid1}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\partightenfactor0

\f0\fs24 \cf0 MYSQL CAPSTONE PROJECT - \
\
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 Intro - \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\partightenfactor0
\cf0    Over the past 18 months, an emerging technology has caught the attention of the world; the NFT. What is an NFT? They are digital assets stored on the blockchain. And over $22 billion was spent last year on purchasing NFTs. Why? People enjoyed the art, the speculated on what they might be worth in the future, and people didn\'92t want to miss out. \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0  \
The future of NFT\'92s is unclear as much of the NFT\'92s turned out to be scams of sorts since the field is wildly unregulated. They\'92re also contested heavily for their impact on the environment.\
 \
Regardless of these controversies, it is clear that there is money to be made in NFT\'92s. And one cool part about NFT\'92s is that all of the data is recorded on the blockchain, meaning anytime something happens to an NFT, it is logged in this database. \
 \
In this project, you\'92ll be tasked to analyze real-world NFT data. \
That data set is a sales data set of one of the most famous NFT projects, Cryptopunks. Meaning each row of the data set represents a sale of an NFT. The data includes sales from January 1st, 2018 to December 31st, 2021. The table has several columns including the buyer address, the ETH price, the price in U.S. dollars, the seller\'92s address, the date, the time, the NFT ID, the transaction hash, and the NFT name.\
You might not understand all the jargon around the NFT space, but you should be able to infer enough to answer the following prompts.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\partightenfactor0
\cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
Questions - \
\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls1\ilvl0
\fs22 \cf2 \cb3 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 How many sales occurred during this time period?\'a0\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Return the top 5 most expensive transactions (by USD price) for this data set. Return the name, ETH price, and USD price, as well as the date.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Return a table with a row for each transaction with an event column, a USD price column, and a moving average of USD price that averages the last 50 transactions.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Return all the NFT names and their average sale price in USD. Sort descending. Name the average column as average_price.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Return each day of the week and the number of sales that occurred on that day of the week, as well as the average price in ETH. Order by the count of transactions in ascending order.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Construct a column that describes each sale and is called summary. The sentence should include who sold the NFT name, who bought the NFT, who sold the NFT, the date, and what price it was sold for in USD rounded to the nearest thousandth.\cb1 \uc0\u8232 \cb3 \'a0Here\'92s an example summary:\cb1 \uc0\u8232 \cb3 \'a0\'93CryptoPunk #1139 was sold for $194000 to 0x91338ccfb8c0adb7756034a82008531d7713009d from 0x1593110441ab4c5f2c133f21b0743b2b43e297cb on 2022-01-14\'94\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Create a view called \'931919_purchases\'94 and contains any sales where \'930x1919db36ca2fa2e15f9000fd9cdc2edcf863e685\'94 was the buyer.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Create a histogram of ETH price ranges. Round to the nearest hundred value.\'a0\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Return a unioned query that contains the highest price each NFT was bought for and a new column called status saying \'93highest\'94 with a query that has the lowest price each NFT was bought for and the status column saying \'93lowest\'94. The table should have a name column, a price column called price, and a status column. Order the result set by the name of the NFT, and the status, in ascending order.\'a0\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 What NFT sold the most each month / year combination? Also, what was the name and the price in USD? Order in chronological format.
\fs32 \cb1 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\partightenfactor0
\cf0 \
\
\
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 Code- \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\partightenfactor0
\cf0 \
\
-- 1 \
SELECT COUNT(*) AS sale_count\
FROM pricedata;\
\
-- 2\
SELECT name , eth_price , usd_price , event_date\
FROM pricedata\
ORDER BY usd_price DESC LIMIT 5;\
\
-- 3 \
\
SELECT event_date, usd_price,\
AVG(usd_price) OVER (ORDER BY event_date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_avg\
FROM pricedata\
ORDER BY event_date;\
\
-- 5 \
SELECT name,\
AVG(usd_price) AS average_price\
FROM pricedata\
GROUP BY name\
ORDER BY average_price DESC;\
\
\
-- 6 \
SELECT DAYNAME(event_date) AS day_of_week,\
    COUNT(*) AS num_sales,\
    AVG(eth_price) AS average_price_eth\
FROM pricedata\
GROUP BY day_of_week\
ORDER BY num_sales ASC;\
\
-- 7 \
\
SELECT\
    *,\
    CONCAT(\
        'Sold by ', seller_address,\
        ' to ', buyer_address,\
        ' for $', ROUND(usd_price, 3),\
        ' on ', DATE_FORMAT(event_date, '%Y-%m-%d')\
    ) AS summary\
FROM\
    pricedata;\
\
 -- 8\
SELECT\
    CONCAT(\
        ROUND(eth_price, 2), ' - ', ROUND(eth_price + 0.01, 2)\
    ) AS price_range,\
    COUNT(*) AS count\
FROM pricedata\
GROUP BY price_range\
ORDER BY price_range;\
\
-- 9\
\
-- Highest Price\
SELECT name AS NFT_Name, MAX(eth_price) AS price,\
'highest' AS status\
FROM pricedata\
GROUP BY NFT_Name\
UNION\
\
-- Lowest Price\
SELECT name AS NFT_Name,\
MIN(eth_price) AS price,\
'lowest' AS status\
FROM pricedata\
GROUP BY NFT_Name\
ORDER BY NFT_Name, status ASC;\
\
\
-- 10 \
SELECT\
  EXTRACT(YEAR FROM event_date) AS year,\
  EXTRACT(MONTH FROM event_date) AS month,\
  token_id,name,usd_price\
FROM pricedata\
GROUP BY year, month, token_id, name, usd_price\
ORDER BY year, month;\
\
-- 11 \
\
SELECT\
  EXTRACT(YEAR FROM event_date) AS year,\
  EXTRACT(MONTH FROM event_date) AS month,\
  ROUND(SUM(usd_price), -2) AS total_volume_usd\
FROM pricedata\
GROUP BY year, month\
ORDER BY year, month;\
\
-- 12\
\
SELECT COUNT(*) AS transaction_count\
FROM pricedata\
WHERE buyer_address = '0x1919db36ca2fa2e15f9000fd9cdc2edcf863e685'\
AND event_date BETWEEN '2018-01-01' AND '2023-08-31';\
\
-- 13\
\
-- part 1 \
CREATE TEMPORARY TABLE daily_average_prices1 AS (\
 SELECT event_date, usd_price,\
 AVG(usd_price) OVER (PARTITION BY event_date) AS average_usd_price\
 FROM pricedata\
);\
\
-- part 2\
SELECT\
  event_date,\
  AVG(usd_price) AS estimated_average_value\
FROM daily_average_prices1\
WHERE usd_price >= 0.1 * average_usd_price\
GROUP BY event_date\
ORDER BY event_date;\
\
-- 14 \
SELECT\
  buyer_address,\
  SUM(usd_price) AS total_cost,\
  AVG(usd_price) AS average_sale_price,\
  AVG(usd_price) - SUM(usd_price) AS profit_loss\
FROM pricedata\
GROUP BY buyer_address\
ORDER BY profit_loss DESC;\
}